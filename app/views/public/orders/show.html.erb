<h1>ECサイト</h1>
<h2>注文履歴詳細</h2>

<h3>注文情報</h3>

<table border="1">
  <tr>
    <th>注文日</th>
    <td><%= @order.created_at %></td>
  </tr>
  <tr>
    <th>注文の配送先</th>
    <td>
      <%= @order.postal_code %><br>
      <%= @order.address %><br>
      <%= @order.name %>
    </td>
  </tr>
  <tr>
    <th>支払い方法</th>
    <td>
      <% if @order.payment_method == "0" %>
        銀行振込
      <% else %>
        クレジットカード
      <% end %>
    </td>
  </tr>
  <tr>
    <th>ステータス</th>
    <td>
      <% case @order.status
            when 0 %>
          入金待ち
        <% when 1 %>
          入金確認
        <% when 2 %>
          製作中
        <% when 3 %>
          発送準備完了
        <% when 4 %>
          発送済み
      <% end %>
    </td>
  </tr>
</table>

<h3>請求情報</h3>

<table border="1">
  <tr>
    <th>合計金額</th>
    <td>
      <%= @order.total_payment - @order.shipping_cost %>
    </td>
  </tr>
  <tr>
    <th>配送料</th>
    <td><%= @order.shipping_cost %></td>
  </tr>
  <tr>
    <th>ご請求額</th>
    <td><%= @order.total_payment %></td>
  </tr>
</table>

<h3>注文内容</h3>

<table border="1">
  <tr>
    <th>商品</th>
    <th>単価（税込）</th>
    <th>個数</th>
    <th>小計</th>
  </tr>
  <% @order_details.each do |order_detail| %>
  <tr>
    <td><%= order_detail.item.name %></td>
    <td><%= order_detail.price %></td>
    <td><%= order_detail.amount %></td>
    <td>
      <% subtotal = order_detail.price * order_detail.amount %>
      <%= subtotal %>
    </td>
  </tr>
  <% end %>
</table>